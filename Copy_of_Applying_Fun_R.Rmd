---
title: An R Markdown document converted from "Copy_of_Applying_Fun_R.ipynb"
output: html_document
---

<a href="https://colab.research.google.com/github/nkinsman16/HW-Week-2--Applying-Functions/blob/main/Copy_of_Applying_Fun_R.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>
#Start Fresh
```{r}
rm(list = ls())
```



# Applying functions in R

#Installing to tead Excel files:

```{r}
#Installs the package "rio"
library(rio)
#install.packages("rio") (Don't need to use this will just install it in the Console of RStudio)
```

# reading data

```{r}
# opening a file from a url (file in Excel), name it 'fragility23'
linkGit<- "https://github.com/nkinsman16/HW-Week-2--Applying-Functions/raw/refs/heads/main/FSI-2023-DOWNLOAD.xlsx"

library(rio) # package needed
fragility23<-rio::import(file = linkGit) #object that will hold the result
```

```{r}
#Prints the structure of the data frame
str(fragility23)
```

## Apply square root function?

```{r}
# whole DF?
#sqrt(fragility23) (Had to comment it out because the RStudio wouldn't allow it to be processed into a HTML)
```

```{r}
# several columns (only numerical)

sqrt(fragility23[,4:5])
```

```{r}
# one column
sqrt(fragility23$Total)
```

```{r}
# one value
sqrt(fragility23$Total[1])
```

## Applying **sum()**:

```{r}
# sum everything
sum(fragility23[,4:5])
```

```{r}
# sum by column
print(apply(fragility23[,4:5],2,sum))
```

```{r}
#notice
typeof(apply(fragility23[,4:5],2,sum))
```

If you do not see **list**, then it is a vector. â«

```{r}
# sum by row
print(apply(fragility23[,4:5],1,sum))
```

### Apply by iterating:

```{r}
#Takes columns 4 and 5 from fragility23, applies the sum function and prints the list
print(lapply(fragility23[,4:5],sum))
```

Notice output of **lapply**:

```{r}
#Always returns a list because of lapply, typeof() Tells the low-level storage type
typeof(lapply(fragility23[,4:5],sum))
```

```{r}
#Always returns a list because of lapply, class() tells how R treats the object
class(lapply(fragility23[,4:5],sum))
```

Notice output of **sapply**:

```{r}
#sapply applies a function to each selected column and simplifies the result to a vector. Takes columns 4 and 5 from fragility23, applies sum() to each column and returns and prints
print(sapply(fragility23[,4:5],sum))
```

```{r}
#sapply() simplifies the output, and results in a numeric vector
class(sapply(fragility23[,4:5],sum))
```

Similarly:

```{r}
#Applies the function sqrt() to each column and prints out a full list
print(lapply(fragility23[,4:5],sqrt))
```

```{r}
#Tells us what type of data the result is
class(lapply(fragility23[,4:5],sqrt))
```

```{r}
#Applies sqrt, and uses sapply to simplify the results
print(sapply(fragility23[,4:5],sqrt))
```

```{r}
#Tells the class of the simplified result
class(sapply(fragility23[,4:5],sqrt))
```

Now our own function:

#Within Collab

```{r}
#Defining the function named 'theOnesOK'
theOnesOK = function(DF_country_and_variable) {
  #Extract the column Specified by the DF Variable from the data frame
  variable_values <- DF_country_and_variable[,2]
  #Calculate the average fo the variable selected and removing missing values
  avg_value <- mean(variable_values, na.rm = TRUE)
  #Compares each value to the average and assigns a label
  is_above <- ifelse(variable_values > avg_value, "Above Average", "Below/At Average") # The condition being met. If the label is True then "Above Average", if it's False "Below/At Average"
  DF_country_and_variable$Status <- is_above #Creattes a new column called 'Status' and filters for those values that equal to "Above Average"
  return(DF_country_and_variable)#Returns the rest of the values that don't meet the Status Condition
}
```

```{r}
theOnesOK(fragility23[,c('Country','S1: Demographic Pressures')])
```

```{r}
#Define the function named mystery: DF: a data frame containing data
#positionsToUse: Which columns of DF you want to average
#CountryColumn=Country: recalling Country variable with CountryColumn
mystery=function(DF,positionsToUse,CountryColumn='Country'){
  #The new variable newDF, selects the new Column 'CountryColumn' and drop=FALSE forces the result to stay a data frame
  newDF=DF[,c(CountryColumn),drop = FALSE]
  #Creates a new variable that stores the string 'average'
  average='average'
  #Takes only the columns you want to average,  "1": apply across rows, "mean": computes the mean of each row, "na.rm" means ignore NA values when computing the mean
  newDF[,average]=apply(DF[,positionsToUse],1,mean,na.rm = TRUE)
  #Returns a data frame containing only the country column and the "average" column
  return(newDF[,c(CountryColumn,average)])
}
```

```{r}
#Putting the function in action
mystery(
  fragility23[, c("Country", "Total", "S1: Demographic Pressures", "S2: Refugees and IDPs")],#Takes the Country Text as one column, then the other columns "Total", "S1: Demographic Pressures", "S2: Refugees and IDPs"" will be used as the average
  positionsToUse = 2:4,#Columns to use for averaging
  CountryColumn = "Country"#Tells the function which column has the country names
)
```

